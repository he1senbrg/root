# Member Queries

## Quick Navigation

- [Overview](1-overview.md)
- [System Architecture](2-system-architecture.md)
  - [Application Configuration](2.1-application-configuration.md)
- [Database Models](3-database-models.md)
  - [Member Model](3.1-member-model.md)
  - [Attendance Model](3.2-attendance-model.md)
  - [Streak Model](3.3-streak-model.md)
  - [Project Model](3.4-project-model.md)
- [GraphQL API](4-graphql-api.md)
  - [GraphQL Queries](4.1-graphql-queries.md)
    - [Member Queries](4.1.1-member-queries.md)
    - [Attendance Queries](4.1.2-attendance-queries.md)
    - [Streak Queries](4.1.3-streak-queries.md)
    - [Project Queries](4.1.4-project-queries.md)
  - [GraphQL Mutations](4.2-graphql-mutations.md)
    - [Member Mutations](4.2.1-member-mutations.md)
    - [Attendance Mutations](4.2.2-attendance-mutations.md)
    - [Streak Mutations](4.2.3-streak-mutations.md)
    - [Project Mutations](4.2.4-project-mutations.md)
- [Background Tasks](5-background-tasks.md)
  - [Daily Attendance Task](5.1-daily-attendance-task.md)
- [Deployment and CI/CD](6-deployment-and-cicd.md)
  - [GitHub Actions Workflows](6.1-github-actions-workflows.md)
  - [Docker Deployment](6.2-docker-deployment.md)
- [Security Features](7-security-features.md)
  - [HMAC Authentication](7.1-hmac-authentication.md)

## Table of Contents

- [Member Queries](#member-queries)
  - [Purpose and Scope](#purpose-and-scope)
  - [Query Structure](#query-structure)
  - [Available Queries](#available-queries)
  - [Query Implementation](#query-implementation)
    - [Members Query](#members-query)
  - [Member Field Resolution](#member-field-resolution)
    - [Data Flow for Member Field Resolution](#data-flow-for-member-field-resolution)
    - [Attendance Field](#attendance-field)
    - [Attendance Summary Field](#attendance-summary-field)
    - [Streak Field](#streak-field)
    - [Projects Field](#projects-field)
  - [Usage Examples](#usage-examples)
    - [Basic Member Query](#basic-member-query)
    - [Filtered Member Query](#filtered-member-query)
    - [Member Query with Related Data](#member-query-with-related-data)
  - [Integration with System](#integration-with-system)

# Member Queries

Relevant source files

* [src/graphql/mutations/project\_mutations.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/mutations/project_mutations.rs)
* [src/graphql/queries/member\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs)
* [src/graphql/queries/project\_queries.rs](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/project_queries.rs)

## Purpose and Scope

This document details the GraphQL query operations related to member data in the Root system. It covers the available member queries, their implementation, and how related data is resolved for member objects. Member queries provide read-only access to member information and their associated data like attendance records, projects, and status update streaks.

For information about modifying member data, see [Member Mutations](/amfoss/root/4.2.1-member-mutations). For other types of queries, refer to [Attendance Queries](/amfoss/root/4.1.2-attendance-queries), [Streak Queries](/amfoss/root/4.1.3-streak-queries), or [Project Queries](/amfoss/root/4.1.4-project-queries).

## Query Structure

Member queries are defined in the `MemberQueries` struct and implemented as GraphQL Object fields. The system allows querying members with optional filtering capabilities and resolving related data for each member.

Sources: [src/graphql/queries/member\_queries.rs12-44](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L12-L44) [src/graphql/queries/member\_queries.rs46-94](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L46-L94)

## Available Queries

The Member Query module provides the following queries:

| Query Name | Description | Parameters | Return Type |
| --- | --- | --- | --- |
| `members` | Retrieves a list of all members, with optional filtering | `year`: optional Integer `group_id`: optional Integer | List of `Member` objects |

Each returned `Member` object can have its related data fields resolved:

| Field Name | Description | Return Type |
| --- | --- | --- |
| `attendance` | Attendance records for the member | List of `AttendanceInfo` objects |
| `attendanceSummary` | Monthly attendance summaries | List of `AttendanceSummaryInfo` objects |
| `streak` | Status update streak information | List of `StatusUpdateStreakInfo` objects |
| `projects` | Projects associated with the member | List of `Project` objects |

Sources: [src/graphql/queries/member\_queries.rs17-43](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L17-L43) [src/graphql/queries/member\_queries.rs46-94](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L46-L94)

## Query Implementation

### Members Query

The main `members` query retrieves a list of members from the database with optional filtering by year and group\_id.

The implementation constructs a dynamic SQL query that conditionally applies filters based on the parameters provided in the GraphQL request:

1. The method accesses the database pool from the GraphQL context
2. A query builder is initialized with the base SELECT statement
3. If a `year` parameter is provided, it adds a filter condition for the year
4. If a `group_id` parameter is provided, it adds a filter for the group\_id
5. The query is executed against the database, returning member records
6. Results are mapped to `Member` objects and returned to the client

Sources: [src/graphql/queries/member\_queries.rs17-43](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L17-L43)

## Member Field Resolution

When a Member object is retrieved, clients can request additional related data. These are implemented as fields on the `Member` type using the `ComplexObject` trait.

### Data Flow for Member Field Resolution

Each field resolver follows a similar pattern:

1. Access the database pool from the GraphQL context
2. Execute a SQL query specific to the field, using the member's ID
3. Map the database results to the appropriate data structure
4. Return the results, with an empty list as fallback in case of errors

### Attendance Field

Retrieves daily attendance records for the member:

### Attendance Summary Field

Retrieves monthly attendance summaries:

### Streak Field

Retrieves status update streak information:

### Projects Field

Retrieves projects associated with the member:

Sources: [src/graphql/queries/member\_queries.rs47-94](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L47-L94)

## Usage Examples

### Basic Member Query

To query all members:

### Filtered Member Query

To query members in a specific year and group:

### Member Query with Related Data

To query members with their attendance and projects:

## Integration with System

Member Queries form a critical component in the Root system, as members are the central entity with relationships to various other data models. The queries provide read access to member data and their related information, supporting various client applications that consume the GraphQL API.

Sources: [src/graphql/queries/member\_queries.rs1-95](https://github.com/amfoss/root/blob/2b58803d/src/graphql/queries/member_queries.rs#L1-L95)